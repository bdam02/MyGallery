<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyGallery Premium 2.0</title>
<style>
:root {
  --bg-light: #f0f4f8;
  --bg-dark: #0b0c1b;
  --card-light: #fff;
  --card-dark: rgba(255,255,255,0.05);
  --text-light: #333;
  --text-dark: #eee;
  --accent: #4CAF50;
  --rename-btn: #2196F3;
  --delete-btn: #ff4d4d;
}

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  display: flex;
  height: 100vh;
  transition: background 0.5s, color 0.5s;
}

body.light {
  background: var(--bg-light);
  color: var(--text-light);
}

body.dark {
  background: var(--bg-dark);
  color: var(--text-dark);
  overflow: hidden;
}

body.dark::before {
  content: '';
  position: fixed;
  top:0;left:0;width:100%;height:100%;
  background: transparent;
  pointer-events: none;
  z-index: 0;
}

/* Sidebar */
#sidebar {
  width: 200px;
  background: rgba(0,0,0,0.1);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  border-right: 1px solid #ccc;
}

body.dark #sidebar {
  background: rgba(255,255,255,0.05);
  border-right: 1px solid rgba(255,255,255,0.1);
}

.gallery-item {
  padding: 8px 10px;
  background: rgba(255,255,255,0.2);
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

body.light .gallery-item {
  background: rgba(0,0,0,0.05);
}

.gallery-item.active {
  font-weight: bold;
  color: var(--accent);
}

.gallery-item button {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 12px;
  color: var(--accent);
}

/* Main content */
#main {
  flex: 1;
  padding: 20px;
  display: flex;
  flex-direction: column;
}

#topControls {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

button, input[type="file"], input[type="text"] {
  padding: 10px 14px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 14px;
  transition: 0.3s;
}

button:hover {
  filter: brightness(0.9);
}

#galleryContainer {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px,1fr));
  gap: 20px;
}

/* File card */
.fileCard {
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  cursor: pointer;
  background: var(--card-light);
  transition: transform 0.3s, box-shadow 0.3s;
}

body.dark .fileCard {
  background: var(--card-dark);
}

.fileCard:hover {
  box-shadow: 0 12px 28px rgba(0,0,0,0.2);
  transform: translateY(-4px);
}

.fileCard img, .fileCard video {
  width: 100%;
  display: block;
  border-bottom: 1px solid #eee;
}

.fileName {
  text-align: center;
  padding: 6px 8px;
  font-size: 14px;
  font-weight: 500;
}

.actionBtn {
  position: absolute;
  top: 10px;
  opacity: 0;
  pointer-events: none;
  padding: 4px 8px;
  font-size: 12px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  transition: 0.3s;
}

.fileCard:hover .actionBtn {
  opacity: 1;
  pointer-events: auto;
}

.renameBtn {
  left: 10px;
  background: var(--rename-btn);
  color: #fff;
}

.deleteBtn {
  right: 10px;
  background: var(--delete-btn);
  color: #fff;
}

#modal {
  display: none;
  position: fixed;
  z-index: 1000;
  top:0;left:0;width:100%;height:100%;
  background: rgba(0,0,0,0.85);
  justify-content: center;
  align-items: center;
}

#modalContent img, #modalContent video {
  max-width: 90%;
  max-height: 90%;
  border-radius: 16px;
}

#closeModal {
  position: absolute;
  top: 20px;
  right: 30px;
  font-size: 36px;
  font-weight: bold;
  cursor: pointer;
  color: #fff;
}
</style>
</head>
<body class="light">

<div id="sidebar">
  <h3>Galleries</h3>
  <div id="galleriesList"></div>
  <button id="addGalleryBtn">Nouvelle gallery</button>
  <button id="toggleMode">Mode Nuit</button>
</div>

<div id="main">
  <div id="topControls">
    <input type="file" id="fileInput" multiple>
    <button id="uploadBtn">Upload</button>
    <button id="clearBtn">Clear Gallery</button>
    <input type="text" id="searchInput" placeholder="Rechercher un fichier...">
  </div>
  <div id="galleryContainer"></div>
</div>

<div id="modal">
  <span id="closeModal">&times;</span>
  <div id="modalContent"></div>
</div>

<script>
// ======== DATA ========
let galleries = JSON.parse(localStorage.getItem('galleries')) || { gallery1: [] };
let currentGallery = 'gallery1';

// ======== ELEMENTS ========
const galleriesList = document.getElementById('galleriesList');
const addGalleryBtn = document.getElementById('addGalleryBtn');
const toggleModeBtn = document.getElementById('toggleMode');
const fileInput = document.getElementById('fileInput');
const uploadBtn = document.getElementById('uploadBtn');
const galleryContainer = document.getElementById('galleryContainer');
const clearBtn = document.getElementById('clearBtn');
const searchInput = document.getElementById('searchInput');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const closeModal = document.getElementById('closeModal');
const body = document.body;

// ======== FUNCTIONS ========
function saveGalleries(){ localStorage.setItem('galleries', JSON.stringify(galleries)); }

function renderGalleries(){
  galleriesList.innerHTML = '';
  for(const name in galleries){
    const div = document.createElement('div');
    div.classList.add('gallery-item');
    if(name === currentGallery) div.classList.add('active');
    div.textContent = name;
    
    const renameBtn = document.createElement('button');
    renameBtn.textContent = 'Rename';
    renameBtn.addEventListener('click',(e)=>{
      e.stopPropagation();
      const newName = prompt("Nouveau nom pour la gallery :", name);
      if(newName && !galleries[newName]){
        galleries[newName] = galleries[name];
        delete galleries[name];
        if(currentGallery === name) currentGallery = newName;
        saveGalleries();
        renderGalleries();
        renderGalleryFiles();
      }
    });
    div.appendChild(renameBtn);

    div.addEventListener('click',()=>{
      currentGallery = name;
      renderGalleries();
      renderGalleryFiles();
    });
    galleriesList.appendChild(div);
  }
}

function renderGalleryFiles(){
  galleryContainer.innerHTML = '';
  const files = galleries[currentGallery];
  files.forEach((fileData, index)=>{
    const card = document.createElement('div');
    card.classList.add('fileCard');

    let content = '';
    if(fileData.type.startsWith("image/")) content += `<img src="${fileData.data}">`;
    else if(fileData.type.startsWith("video/")) content += `<video src="${fileData.data}" controls></video>`;
    else content += `<a href="${fileData.data}" download>Download</a>`;

    content += `<div class="fileName">${fileData.name}</div>`;
    content += `<button class="actionBtn renameBtn">Rename</button>`;
    content += `<button class="actionBtn deleteBtn">X</button>`;
    card.innerHTML = content;

    const renameBtn = card.querySelector('.renameBtn');
    const deleteBtn = card.querySelector('.deleteBtn');
    const nameDiv = card.querySelector('.fileName');

    renameBtn.addEventListener('click',()=>{
      const newName = prompt("Nouveau nom pour ce fichier :", fileData.name);
      if(newName){
        fileData.name = newName.trim();
        nameDiv.textContent = fileData.name;
        saveGalleries();
      }
    });

    deleteBtn.addEventListener('click',(e)=>{
      e.stopPropagation();
      galleries[currentGallery].splice(index,1);
      saveGalleries();
      renderGalleryFiles();
    });

    card.addEventListener('click',(e)=>{
      if(e.target!==renameBtn && e.target!==deleteBtn){
        modalContent.innerHTML = '';
        if(fileData.type.startsWith("image/")){
          const img = document.createElement('img');
          img.src = fileData.data;
          modalContent.appendChild(img);
        }else if(fileData.type.startsWith("video/")){
          const vid = document.createElement('video');
          vid.src = fileData.data;
          vid.controls = true;
          vid.autoplay = true;
          modalContent.appendChild(vid);
        }
        modal.style.display='flex';
      }
    });

    galleryContainer.appendChild(card);
  });
}

// ======== EVENTS ========
uploadBtn.addEventListener('click',()=>{
  const files = fileInput.files;
  if(files.length===0) return alert("SÃ©lectionne des fichiers !");
  Array.from(files).forEach(file=>{
    const reader = new FileReader();
    reader.onload = (e)=>{
      const fileData = { name:file.name, type:file.type, data:e.target.result };
      galleries[currentGallery].push(fileData);
      saveGalleries();
      renderGalleryFiles();
    }
    reader.readAsDataURL(file);
  });
  fileInput.value='';
});

clearBtn.addEventListener('click',()=>{
  if(confirm("Supprimer toute la gallery ?")){
    galleries[currentGallery] = [];
    saveGalleries();
    renderGalleryFiles();
  }
});

searchInput.addEventListener('input',()=>{
  const query = searchInput.value.toLowerCase();
  document.querySelectorAll('.fileCard').forEach(card=>{
    const name = card.querySelector('.fileName').textContent.toLowerCase();
    card.style.display = name.includes(query)?'block':'none';
  });
});

closeModal.addEventListener('click',()=>modal.style.display='none');
modal.addEventListener('click',e=>{ if(e.target===modal) modal.style.display='none'; });

addGalleryBtn.addEventListener('click',()=>{
  const newName = prompt("Nom de la nouvelle gallery :","gallery"+(Object.keys(galleries).length+1));
  if(newName && !galleries[newName]){
    galleries[newName] = [];
    saveGalleries();
    renderGalleries();
  }
});

toggleModeBtn.addEventListener('click',()=>{
  body.classList.toggle('dark');
  body.classList.toggle('light');
});

// ======== INIT ========
renderGalleries();
renderGalleryFiles();
</script>
</body>
</html>













