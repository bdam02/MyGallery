<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyGallery Premium 4.4</title>
<style>
body{
  margin:0;
  font-family:'Segoe UI',Tahoma,Verdana,sans-serif;
  display:flex;
  height:100vh;
  background:#000;
  color:#fff;
  overflow:hidden;
  position:relative;
}
.star{position:absolute;background:white;border-radius:50%;opacity:0.6;animation:twinkle 4s infinite alternate;}
@keyframes twinkle{0%,100%{opacity:0.2}50%{opacity:1}}
#sidebar{width:240px;background:rgba(255,255,255,0.04);padding:20px;display:flex;flex-direction:column;gap:28px;border-right:1px solid rgba(255,255,255,0.1);z-index:2;}
#sidebar h3{margin:0;}
#galleriesList{display:flex;flex-direction:column;gap:36px;}
.gallery-item{padding:14px 16px;border-radius:14px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;color:white;box-shadow:0 0 16px currentColor;transition:transform 0.25s, box-shadow 0.25s;}
.gallery-item:hover{transform:scale(1.04);box-shadow:0 0 26px currentColor;}
.gallery-item .btnGroup{display:flex;gap:1px;}
.gallery-item button{background:none;border:none;color:white;cursor:pointer;font-size:14px;padding:4px;}
#galleryCounter{margin-top:auto;text-align:center;font-size:13px;opacity:0.7;}
.colorPicker{position:absolute;display:none;grid-template-columns:repeat(3,18px);gap:8px;padding:10px;background:rgba(0,0,0,0.9);border-radius:12px;box-shadow:0 0 18px rgba(255,255,255,0.4);z-index:999;}
.colorBox{width:18px;height:18px;border-radius:4px;cursor:pointer;box-shadow:0 0 6px rgba(255,255,255,0.9);}
#main{flex:1;padding:20px;display:flex;flex-direction:column;position:relative;}
#currentGalleryName{font-size:22px;margin-bottom:14px;}
#topControls{display:flex;gap:10px;margin-bottom:20px;}
input, button{padding:10px 14px;border-radius:10px;border:none;font-size:14px;}
#galleryContainer{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:36px;}
.fileCard{position:relative;background:rgba(255,255,255,0.05);border-radius:16px;overflow:hidden;box-shadow:0 0 6px rgba(255,255,255,0.25);transform:translateY(20px);opacity:0;transition:0.4s;}
.fileCard.show{transform:translateY(0);opacity:1;}
.fileCard:hover{transform:translateY(-5px);box-shadow:0 15px 30px rgba(0,0,0,0.6);}
.fileCard img,.fileCard video{width:100%;}
.fileName{text-align:center;padding:6px;}
.actionBtn{position:absolute;top:10px;padding:4px 8px;border:none;border-radius:6px;cursor:pointer;color:white;}
.renameBtn{left:10px;background:#2196F3;}
.deleteBtn{right:10px;background:#ff4d4d;}
#modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);justify-content:center;align-items:center;z-index:1000;}
#modal img,#modal video{max-width:90%;max-height:90%;border-radius:16px;}
#closeModal{position:absolute;top:20px;right:30px;font-size:36px;cursor:pointer;}

/* ===== USERNAME ===== */
#usernameOverlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.95);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:10000;
}
#usernameOverlay input{
  font-size:20px;
  padding:12px 16px;
  border-radius:12px;
  border:none;
  outline:none;
  text-align:center;
}
#usernameDisplay{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:48px;
  color:#fff;
  text-shadow:0 0 12px #fff,0 0 24px #fff;
  animation:float 3s ease-in-out infinite alternate;
  pointer-events:none;
}
@keyframes float{0%{transform:translate(-50%,-50%) translateY(0px);}100%{transform:translate(-50%,-50%) translateY(8px);}}
#changeUsernameBtn{
  position:absolute;
  top:20px;
  right:20px;
  font-size:18px;
  padding:6px 10px;
  background:#2196F3;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>
<body>
<div id="sidebar">
  <h3>Galleries</h3>
  <div id="galleriesList"></div>
  <button id="addGalleryBtn">âž•</button>
  <div id="galleryCounter">1 / 10</div>
</div>

<div id="main">
  <div id="currentGalleryName">gallery1</div>
  <button id="changeUsernameBtn">Change Username</button>
  <div id="topControls">
    <input type="file" id="fileInput" multiple>
    <button id="uploadBtn">Upload</button>
    <button id="clearBtn">Clear Gallery</button>
    <input type="text" id="searchInput" placeholder="Rechercher...">
  </div>
  <div id="galleryContainer"></div>
</div>

<div id="modal">
  <span id="closeModal">&times;</span>
  <div id="modalContent"></div>
</div>

<div id="usernameOverlay">
  <h2>Entre ton username :</h2>
  <input type="text" id="usernameInput" placeholder="Ton pseudo">
</div>
<div id="usernameDisplay"></div>

<script>
const MAX_GALLERIES=10;
const colors=["white","red","orange","yellow","green","blue","purple","#ff33cc"];
let galleries=JSON.parse(localStorage.getItem("galleries"))||{gallery1:{files:[],color:"white"}};
let currentGallery="gallery1";
let openPicker=null;
let username=localStorage.getItem("username")||"";

const galleriesList=document.getElementById("galleriesList");
const galleryContainer=document.getElementById("galleryContainer");
const fileInput=document.getElementById("fileInput");
const uploadBtn=document.getElementById("uploadBtn");
const clearBtn=document.getElementById("clearBtn");
const counter=document.getElementById("galleryCounter");
const addGalleryBtn=document.getElementById("addGalleryBtn");
const modal=document.getElementById("modal");
const modalContent=document.getElementById("modalContent");
const closeModal=document.getElementById("closeModal");
const currentGalleryName=document.getElementById("currentGalleryName");
const usernameOverlay=document.getElementById("usernameOverlay");
const usernameInput=document.getElementById("usernameInput");
const usernameDisplay=document.getElementById("usernameDisplay");
const changeUsernameBtn=document.getElementById("changeUsernameBtn");

function save(){localStorage.setItem("galleries",JSON.stringify(galleries));localStorage.setItem("username",username);}
function updateCounter(){counter.textContent=`${Object.keys(galleries).length} / ${MAX_GALLERIES}`; addGalleryBtn.style.display=Object.keys(galleries).length>=MAX_GALLERIES?"none":"block";}
function updateCurrentGalleryName(){currentGalleryName.textContent=currentGallery;}
function updateUsernameDisplay(){usernameDisplay.textContent=username;}

function renderGalleries(){
  galleriesList.innerHTML="";
  document.querySelectorAll(".colorPicker").forEach(p=>p.remove());
  openPicker=null;
  for(const name in galleries){
    const g=galleries[name];
    const div=document.createElement("div");
    div.className="gallery-item";
    div.style.color=g.color;
    div.textContent=name;

    const btnGroup=document.createElement("div");
    btnGroup.className="btnGroup";

    const renameBtn=document.createElement("button");
    renameBtn.textContent="âœï¸";
    renameBtn.onclick=e=>{
      e.stopPropagation();
      const n=prompt("Nouveau nom :",name);
      if(n&&!galleries[n]){
        galleries[n]=galleries[name];
        delete galleries[name];
        currentGallery=n;
        save();renderGalleries();renderFiles();updateCurrentGalleryName();
      }
    };

    const deleteGalleryBtn=document.createElement("button");
    deleteGalleryBtn.textContent="ðŸ—‘ï¸";
    deleteGalleryBtn.onclick=e=>{
      e.stopPropagation();
      if(confirm("Supprimer cette galerie ?")){
        delete galleries[name];
        if(currentGallery===name)currentGallery=Object.keys(galleries)[0]||"gallery1";
        save();renderGalleries();renderFiles();updateCurrentGalleryName();
      }
    };

    const paletteBtn=document.createElement("button");
    paletteBtn.textContent="ðŸŽ¨";

    const picker=document.createElement("div");
    picker.className="colorPicker";
    colors.forEach(c=>{
      const box=document.createElement("div");
      box.className="colorBox";
      box.style.background=c;
      box.onclick=e=>{
        e.stopPropagation();
        g.color=c;
        save();picker.style.display="none";openPicker=null;renderGalleries();
      };
      picker.appendChild(box);
    });

    paletteBtn.onclick=e=>{
      e.stopPropagation();
      if(openPicker===picker){picker.style.display="none";openPicker=null;return;}
      document.querySelectorAll(".colorPicker").forEach(p=>p.style.display="none");
      const r=div.getBoundingClientRect();
      picker.style.top=r.top+"px";
      picker.style.left=(r.right+22)+"px";
      picker.style.display="grid";
      openPicker=picker;
    };

    btnGroup.append(renameBtn,paletteBtn,deleteGalleryBtn);
    div.appendChild(btnGroup);
    document.body.appendChild(picker);
    div.onclick=()=>{currentGallery=name;renderGalleries();renderFiles();updateCurrentGalleryName();};
    galleriesList.appendChild(div);
  }
  updateCounter();
  updateCurrentGalleryName();
}

function renderFiles(){
  galleryContainer.innerHTML="";
  galleries[currentGallery].files.forEach((f,i)=>{
    const c=document.createElement("div");
    c.className="fileCard";
    let html="";
    if(f.type.startsWith("image")) html=`<img src="${f.data}">`;
    else if(f.type.startsWith("video")) html=`<video src="${f.data}" controls></video>`;
    html+=`<div class="fileName">${f.name}</div>
           <button class="actionBtn renameBtn">Rename</button>
           <button class="actionBtn deleteBtn">X</button>`;
    c.innerHTML=html;
    c.querySelector(".renameBtn").onclick=e=>{
      e.stopPropagation();
      const n=prompt("Nouveau nom :",f.name);
      if(n){f.name=n;save();renderFiles();}
    };
    c.querySelector(".deleteBtn").onclick=e=>{
      e.stopPropagation();
      galleries[currentGallery].files.splice(i,1);save();renderFiles();
    };
    c.onclick=()=>{modalContent.innerHTML=f.type.startsWith("image")?`<img src="${f.data}">`:`<video src="${f.data}" controls autoplay></video>`;modal.style.display="flex";};
    galleryContainer.appendChild(c);
    setTimeout(()=>c.classList.add("show"),50*i);
  });
}

uploadBtn.onclick=()=>{
  const files=[...fileInput.files];
  if(files.length===0){alert("SÃ©lectionne des fichiers");return;}
  files.forEach(file=>{
    const reader=new FileReader();
    reader.onload=e=>{
      galleries[currentGallery].files.push({name:file.name,type:file.type,data:e.target.result});
      save();renderFiles();
    };
    reader.readAsDataURL(file);
  });
  fileInput.value="";
};

clearBtn.onclick=()=>{if(confirm("Supprimer toute la galerie ?")){galleries[currentGallery].files=[];save();renderFiles();}};
addGalleryBtn.onclick=()=>{
  if(Object.keys(galleries).length>=MAX_GALLERIES){alert("Limite atteinte");return;}
  const n=prompt("Nom de la nouvelle galerie :");
  if(n&&!galleries[n]){galleries[n]={files:[],color:"white"};save();renderGalleries();}
};

closeModal.onclick=()=>modal.style.display="none";
modal.onclick=e=>{if(e.target===modal)modal.style.display="none";}

/* ===== STARS ===== */
for(let i=0;i<220;i++){const s=document.createElement("div");s.className="star";s.style.top=Math.random()*100+"%";s.style.left=Math.random()*100+"%";s.style.width=s.style.height=(Math.random()*2+1)+"px";document.body.appendChild(s);}

/* ===== USERNAME ===== */
if(username){usernameOverlay.style.display="none";updateUsernameDisplay();}else{usernameOverlay.style.display="flex";}
usernameInput.onkeydown=e=>{
  if(e.key==="Enter" && usernameInput.value.trim()!==""){
    username=usernameInput.value.trim();
    save();
    usernameOverlay.style.display="none";
    updateUsernameDisplay();
  }
};
changeUsernameBtn.onclick=()=>{
  const n=prompt("Nouveau username :",username);
  if(n){username=n.trim();save();updateUsernameDisplay();}
};

renderGalleries();renderFiles();
</script>
</body>
</html>


